import grequests
import time
import datetime 
import math
import itertools
import json
import requests

start_t = time.time()
urls = ["https://gradientone-prod.appspot.com/bscopedata/Acme/Tahoe/mac/143706857100",
        "https://gradientone-prod.appspot.com/bscopedata/Acme/Tahoe/mac/143706857200",
        "https://gradientone-prod.appspot.com/bscopedata/Acme/Tahoe/mac/143706857300",]


a = {'start_tse': 1437068057100, 'cha': '[1.71875, 1.67578125, 1.67578125, 1.6328125, 1.6328125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.76171875, 1.8046875, 1.76171875, 1.76171875, 1.76171875, 1.71875, 1.67578125, 1.6328125, 1.67578125, 1.67578125, 1.67578125, 1.71875, 1.71875, 1.71875, 1.8046875, 1.8046875, 1.76171875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.67578125, 1.6328125, 1.6328125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.71875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875]', 'i_settings': {'BitScope': ['BS000501', 'KD58VM58'], 'Library': ['2.0 FE26A', 'Python DC01L'], 'Channels': [10, 2, 8], 'Sample_Size': 200, 'Link': 'USB:/dev/ttyUSB0', 'Sample_Rate_Hz': 1000.0}, 'testplan_name': u'addone', 'p_settings': {'Total_Slices': 2, 'Start_TSE': '1437068057100', 'Dec_msec_btw_samples': 10, 'Raw_msec_btw_samples': 1, 'Slice_Size_msec': 100}, 'slicename': 1437068057100}
b = {'start_tse': 1437068057200, 'cha': '[1.71875, 1.67578125, 1.67578125, 1.6328125, 1.6328125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.76171875, 1.8046875, 1.76171875, 1.76171875, 1.76171875, 1.71875, 1.67578125, 1.6328125, 1.67578125, 1.67578125, 1.67578125, 1.71875, 1.71875, 1.71875, 1.8046875, 1.8046875, 1.76171875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.67578125, 1.6328125, 1.6328125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.71875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875]', 'i_settings': {'BitScope': ['BS000501', 'KD58VM58'], 'Library': ['2.0 FE26A', 'Python DC01L'], 'Channels': [10, 2, 8], 'Sample_Size': 200, 'Link': 'USB:/dev/ttyUSB0', 'Sample_Rate_Hz': 1000.0}, 'testplan_name': u'addone', 'p_settings': {'Total_Slices': 2, 'Start_TSE': '1437068057100', 'Dec_msec_btw_samples': 10, 'Raw_msec_btw_samples': 1, 'Slice_Size_msec': 100}, 'slicename': 1437068057100}
c = {'start_tse': 1437068057300, 'cha': '[1.71875, 1.67578125, 1.67578125, 1.6328125, 1.6328125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.76171875, 1.8046875, 1.76171875, 1.76171875, 1.76171875, 1.71875, 1.67578125, 1.6328125, 1.67578125, 1.67578125, 1.67578125, 1.71875, 1.71875, 1.71875, 1.8046875, 1.8046875, 1.76171875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.67578125, 1.6328125, 1.6328125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.71875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.67578125, 1.71875, 1.71875, 1.76171875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875, 1.71875, 1.71875, 1.67578125, 1.67578125, 1.67578125, 1.67578125, 1.6328125, 1.71875, 1.71875, 1.76171875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.8046875, 1.76171875, 1.71875]', 'i_settings': {'BitScope': ['BS000501', 'KD58VM58'], 'Library': ['2.0 FE26A', 'Python DC01L'], 'Channels': [10, 2, 8], 'Sample_Size': 200, 'Link': 'USB:/dev/ttyUSB0', 'Sample_Rate_Hz': 1000.0}, 'testplan_name': u'addone', 'p_settings': {'Total_Slices': 2, 'Start_TSE': '1437068057100', 'Dec_msec_btw_samples': 10, 'Raw_msec_btw_samples': 1, 'Slice_Size_msec': 100}, 'slicename': 1437068057100}
window_a = {'cha':a, 'start_tse':'143706857100'}
window_b = {'cha':b, 'start_tse':'143706857200'}
window_c = {'cha':c, 'start_tse':'143706857300'}

out_a = json.dumps(window_a, ensure_ascii=True)
out_b = json.dumps(window_b, ensure_ascii=True)
out_c = json.dumps(window_c, ensure_ascii=True)

headers = {'Content-type': 'application/json', 'Accept': 'text/plain'}

params = {'out_bscope':window_a, 'out_bscope':window_b,'out_bscope':window_c}
rs = (grequests.post(u, json=params, headers=headers) for u in urls)
grequests.map(rs)
finish_t = time.time()
total_t = finish_t - start_t
print total_t, "total time"